---
export const prerender = true;
import Button from "@/components/Button/Button.astro";
import IframeComponent from "@/components/IframeComponent/IframeComponent.astro";
import PageHeader from "@/components/PageHeader/PageHeader.astro";
import siteData from "@/config/siteData.json";
import BaseLayout from "@layouts/BaseLayout.astro";
import { Image } from "astro:assets";
import { render } from "astro:content";
import { type CollectionEntry, getCollection } from "astro:content";
import {
	CheckCheck,
	CheckCircle,
	CornerRightDown,
	MapPin,
	Navigation,
} from "lucide-react";

export async function getStaticPaths() {
	const trainingItems = await getCollection("trainings");
	return trainingItems.map((item) => ({
		params: { trainings: item.id },
		props: item,
	}));
}
type Props = CollectionEntry<"trainings">;

const item = Astro.props;
const { Content } = await render(item);
---

<BaseLayout title={item.data.title + " - " + siteData.title} description={item.data.description}>
	<div class="site-container mx-auto px-4">
		<!-- subtle background gradient effect -->
		<div
			class="pointer-events-none absolute top-1/2 left-1/2 h-[600px] w-[600px] -translate-x-1/2 -translate-y-1/2 scale-[.7] rounded-full bg-orange-100 opacity-40 blur-[100px]"
		>
		</div>
		<!-- Hero Section -->
		<header class="relative overflow-hidden pt-16 pb-24 lg:pt-24 lg:pb-32">
			<div class="relative z-[11] mx-auto max-w-4xl px-4 text-center">
				<h1
					class="mb-6 text-4xl leading-tight font-extrabold tracking-tight text-gray-900 md:text-6xl"
				>
					{item.data.title}
				</h1>
				{item.data.subtitle && (
					<p class="mx-auto leading-relaxed max-w-2xl mb-8 md:text-xl text-gray-600 text-lg"><span class="font-semibold border-b-2 border-primary text-gray-900">{item.data.subtitle}</span></p>
				)}
				<p class="mx-auto mb-8 max-w-2xl text-lg leading-relaxed text-gray-600 md:text-xl" set:html={item.data.description} />
			</div>

			<Button
				class="bg-primary scroll-button m-auto mt-8 w-full max-w-max rounded-lg px-12 py-4 text-lg font-extrabold shadow-xl shadow-orange-200 transition-all duration-300 hover:scale-105 hover:bg-orange-400"
				href="#iframe"
			>
				{item.data.button}<CornerRightDown size={18} />
			</Button>

			<div class="mt-8 flex flex-col justify-center gap-4 sm:flex-row">
				{item.data.badgeGroup?.map((badge) => (
					<div class="flex items-center justify-center gap-2 text-sm font-medium text-gray-500">
						<CheckCircle className="text-primary h-4 w-4" />
						<span>{badge}</span>
					</div>
				))}
			</div>
		</header>

		<section class="mx-auto mb-16 max-w-6xl px-4">
			<div class="grid grid-cols-1 items-start gap-12 lg:grid-cols-2">
				{
						item.data.leftColumnImage && (
						<div class="group relative">
							<div
								class="bg-primary absolute -inset-2 rounded-2xl opacity-20 blur-lg transition duration-500 group-hover:opacity-30"
							>
							</div>
							<!-- Image Section -->
								
								<div class="relative overflow-hidden rounded-2xl border border-gray-200 shadow-xl">
									<Image
										src={item.data.leftColumnImage}
										alt={item.data.title}
											class="h-auto w-full transform object-cover transition duration-700 group-hover:scale-105"
										/>
								</div>	
							
						</div>
						)
				}
				<div>
					<h2 class="mb-6 flex items-center gap-3 text-3xl font-bold text-gray-900">
						<span class="bg-primary h-8 w-2 rounded-full"></span>
						{item.data.rightColumnTitle}
					</h2>
					<p class="mb-6 text-gray-600">{item.data.rightColumnDescription}</p>
					<div class="grid grid-cols-1 gap-x-4 gap-y-3">
						<div class="space-y-8">
							{
								item.data.rightColumnList?.map((listItem) => (
									<div>
										<h3 class="mb-2 text-sm font-semibold tracking-wider text-gray-400 uppercase">
											{listItem.listTitle}
										</h3>
										<ul class="grid grid-cols-2 space-y-2">
											{listItem.listItem?.map((item) => (
												<li class="flex items-start gap-3">
													<CheckCheck className="text-primary mt-0.5 h-5 w-5 flex-shrink-0" />
													<span class="text-gray-700">{item}</span>
												</li>
											))}
										</ul>
									</div>
								))
							}
						</div>
					</div>
				</div>
			</div>
		</section>
			{item.data.hasMap.value && 
			<section class="bg-surface border-y border-gray-200 py-20">
				<div class="mx-auto max-w-6xl px-4">
					<div
						class="grid grid-cols-1 gap-8 overflow-hidden rounded-3xl border border-gray-100 bg-white shadow-xl md:grid-cols-2"
				>
					<!-- Info -->
					<div class="flex flex-col justify-center p-8 md:p-12">
						<div class="mb-6">
							<span class="text-primary text-sm font-bold tracking-wider uppercase">Location</span>
							<h3 class="mt-2 text-3xl font-bold text-gray-900">{item.data.hasMap.value.mapTitle}</h3>
						</div>

						<div class="space-y-6">
							<div class="flex items-start gap-4">
								<div class="text-primary rounded-lg bg-orange-50 p-3">
									<MapPin className="text-primary mt-0.5 h-5 w-5 flex-shrink-0" />
								</div>
								<div>
									{item.data.hasMap.value.address && item.data.hasMap.value.address.map((address, index) => (
										<>
										{index === 0 ? <p class="font-semibold text-gray-900">{address}</p> : <p class="text-gray-600">{address}</p>}
										</>
									))}
								</div>
							</div>

							<div class="flex items-start gap-4">
								<div class="text-primary rounded-lg bg-orange-50 p-3">
									<Navigation className="text-primary mt-0.5 h-5 w-5 flex-shrink-0" />
								</div>
								<div>
									<p class="font-semibold text-gray-900">Directions</p>
									<a
										href={item.data.hasMap.value.mapLink}
										target="_blank"
										class="text-primary underline transition-colors hover:text-orange-600"
									>
										Open in Google Maps &rarr;
									</a>
								</div>
							</div>
						</div>
					</div>

					<!-- Map -->
					<div class="relative h-64 min-h-[300px] bg-gray-100 md:h-auto">
						<iframe
							class="absolute inset-0 h-full w-full opacity-80 grayscale transition duration-500 hover:opacity-100 hover:grayscale-0"
							loading="lazy"
							src={item.data.hasMap?.value.mapLink}
							title={item.data.hasMap?.value.mapTitle}
							aria-label={item.data.hasMap?.value.mapTitle}
						>
						</iframe>
					</div>
				</div>
			</div>
		</section>
		}
	</div>

	<!-- Bottom Sticky CTA for Mobile or Footer CTA -->
	<div id="register" class="border-t border-gray-200 bg-gray-50 py-12 register">
		<div class="site-container mx-auto px-4 text-center">
			<Content />
		</div>
		{item.data.iframeUrl && (
			<div class="site-container text-center" id="iframe">
				<IframeComponent
					height={item.data.iframeHeight}
					width={item.data.iframeWidth}
					src={item.data.iframeUrl}
				/>
			</div>
		)}
</BaseLayout>

<style is:inline>
	.prose {
		@apply text-gray-700;
	}
	.prose h2 {
		@apply mt-12 mb-6 text-3xl font-bold text-gray-900;
	}
	.prose h3 {
		@apply mt-8 mb-4 text-2xl font-bold text-gray-900;
	}
	.prose p {
		@apply mb-4 leading-relaxed;
	}
	.prose ul,
	.prose ol {
		@apply my-6 space-y-2;
	}
	.prose li {
		@apply leading-relaxed;
	}
	.prose a {
		@apply text-primary underline transition-colors hover:text-orange-600;
	}
	.prose img {
		@apply my-8 rounded-lg shadow-md;
	}
</style>
