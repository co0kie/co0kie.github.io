---
interface Props {
	src?: string;
	height?: number;
	width?: string;
}

const { src = "", height = 800, width = "1200" } = Astro.props;
---

<div class="iframe-container relative mt-8 flex w-full justify-center">
	<div
		class="loading-skeleton absolute inset-0 mx-auto animate-pulse rounded-lg bg-gray-200"
		style={`height: ${height}px; width: ${width}px;`}
	>
		<div class="flex h-full items-center justify-center">
			<div class="text-gray-400">Loading...</div>
		</div>
	</div>
	<iframe
		src={src}
		height={height}
		width={width}
		class="iframe-content border-0"
		style={`width: ${width}px; opacity: 0; transition: opacity 0.3s ease-in-out;`}
		allowfullscreen
		loading="lazy"
		title="InstructorsDash"></iframe>
</div>

<script>
	// Client-side script to handle iframe loading
	document.addEventListener("DOMContentLoaded", () => {
		const containers = document.querySelectorAll(".iframe-container");

		containers.forEach((container) => {
			const iframe = container.querySelector(".iframe-content") as HTMLIFrameElement;
			const skeleton = container.querySelector(".loading-skeleton") as HTMLElement;

			if (iframe && skeleton) {
				iframe.addEventListener("load", () => {
					skeleton.style.display = "none";
					iframe.style.opacity = "1";
				});
			}
		});
	});
</script>

<style>
	.iframe-container {
		position: relative;
	}

	.loading-skeleton {
		animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
	}

	@keyframes pulse {
		0%,
		100% {
			opacity: 1;
		}
		50% {
			opacity: 0.5;
		}
	}
</style>
